function k = bliqmix( xy, thick, EE )% bliqmix.m - Generates Blinear Isoparametric Quadrilateral%             element stiffness matrix by mixed order integration.%% Written by: Robert A. Canfield% Created:    27 Jun 01% Modified:   14 Aug 01%%--INPUT%%  xy....... nodal coordinates in each row,%            x in column 1, y in column 2%  thick.... membrane thickness%  EE....... Elastic constant matrix (3x3)%%--OUTPUT%%  k........ BLIQ element stiffness%%--Local variables%%  n........ number of element degrees of freedom%  B........ strain-displacement matrix%  xi,eta... Current Gauss point%  DN....... Derivatives of shape functions wrt to natural coordinates%  Nxy...... Derivatives of shape functions wrt to Cartesian coordinates%  J........ Jacobian matrix%  GaussPoints... Natural coordinates of Gauss points%%--BEGIN%%  Initialize variables%[npe,ndf]=size(xy);n = npe*ndf;k = zeros(n,n);B = zeros(3,n);GaussPoints = [-1 1]/sqrt(3);%%  Double loop for Full order (2 by 2) Gauss quadrature of normal strain terms%for xi=GaussPoints;   for eta=GaussPoints;      DN = 1/4 * [         -(1-eta), (1-eta), (1+eta), -(1+eta)         -(1-xi), -(1+xi),  (1+xi),   (1-xi) ];      J = DN*xy;      Nxy = J \ DN;      B(1,[1 3 5 7]) = Nxy(1,:);      B(2,[2 4 6 8]) = Nxy(2,:);      k = k + B'*(EE*B*(thick*abs(det(J))));   endend%%  Reduced order (1 by 1) integration for shear terms%xi = 0;eta = 0;weight = 2;      DN = 1/4 * [         -(1-eta), (1-eta), (1+eta), -(1+eta)         -(1-xi), -(1+xi),  (1+xi),   (1-xi) ];      J = DN*xy;      Nxy = J \ DN;      B(3,[1 3 5 7]) = Nxy(2,:);      B(3,[2 4 6 8]) = Nxy(1,:);      kshear = B(3,:)'*(EE(3,3)*B(3,:)*(thick*abs(det(J))*weight^2));k = k + kshear;